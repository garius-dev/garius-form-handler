const GariusFormHandler={defaults:{asyncResponse:!1,enableValidation:!0,onJsonResponse:null,onPartialViewResponse:null,onErrorResponse:null,beforeSend:null,setLoadingState:null,resetLoadingState:null,resetOnSuccess:!0,resetOnError:!0,notifier:{success:e=>alert(e),error:e=>alert(e),warning:e=>alert(e)}},init(e,t){if(!e||"string"!=typeof e||""===e.trim())throw new Error("A valid non-empty selector is required.");const n={...this.defaults,...t};document.addEventListener("DOMContentLoaded",(()=>{const t=document.querySelectorAll(e);0===t.length&&console.warn(`The selector "${e}" does not match any element.`),t.forEach((e=>this.setupForm(e,n)))}))},setupForm(e,t){let n=!1,o=!1;e.addEventListener("submit",(async a=>{if(n)return a.preventDefault(),void console.warn("Submission already in progress... ignoring duplicate click.");a.stopPropagation(),a.stopImmediatePropagation();const r=$(e);if(t.enableValidation)if(void 0!==$.validator&&r.validate){if(r.data("validator")||$.validator.unobtrusive.parse(r),!r.valid())return a.preventDefault(),!1}else console.warn("jQuery Validation not found. Validation skipped.");if(n=!0,t.setLoadingState&&"function"==typeof t.setLoadingState&&t.setLoadingState(e),!t.asyncResponse||t.asyncResponse&&null===t.onJsonResponse&&null===t.onPartialViewResponse)return;a.preventDefault();const s=e.action,i=e.method||"POST",l=new FormData(e),d={method:i,body:l,redirect:"manual"};if(t.beforeSend&&"function"==typeof t.beforeSend){if(!1===t.beforeSend(e,l,d))return void(t.resetLoadingState&&"function"==typeof t.resetLoadingState&&t.resetLoadingState(e))}try{const n=await fetch(s,d);if(!n.ok)throw new Error("Something went wrong.");const a=n.headers.get("Content-Type"),r="true"===n.headers.get("X-Partial-View");if(a&&a.includes("application/json")){if("function"==typeof t.onJsonResponse){const o=await n.json();t.onJsonResponse(e,o)}o=!0}else if(a&&a.includes("text/html")&&r){if("function"==typeof t.onPartialViewResponse){const o=await n.text();t.onPartialViewResponse(e,o)}o=!0}else o=!0,t.notifier.warning("No valid callback detected. Ensure your response type matches the expected async handling!.")}catch(n){o=!1,"function"==typeof t.onErrorResponse?t.onErrorResponse(e,n):t.notifier.error(n.message)}finally{n=!1,t.resetLoadingState&&"function"==typeof t.resetLoadingState&&t.resetLoadingState(e),(o&&t.resetOnSuccess||!o&&t.resetOnError)&&e.reset()}}))}};